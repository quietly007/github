```mermaid
%%{init: {'theme': 'dark'}}%%
flowchart TB
    subgraph SECURITY["ğŸ›¡ï¸ SECURITY ARCHITECTURE - VERIFIED"]
        direction TB
    end
    
    subgraph LAYER1["Layer 1: Edge Protection"]
        CF["â˜ï¸ Cloudflare<br/>DDoS Protection<br/>WAF Rules"]
        DNS["ğŸŒ DNS<br/>quietly.its.me<br/>quietly.online"]
    end
    
    subgraph LAYER2["Layer 2: Reverse Proxy"]
        TRAEFIK_M["ğŸš¦ Master Traefik v3.6.6<br/>33 Routes Active<br/>TLS Termination"]
        TRAEFIK_L["ğŸš¦ Lady Traefik<br/>Business Services<br/>TLS Termination"]
    end
    
    subgraph LAYER3["Layer 3: Intrusion Prevention"]
        CS_M["ğŸ›¡ï¸ CrowdSec Master v1.6.8<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>ğŸ“Š 55 Scenarios Active<br/>ğŸ” 12,630 Lines Analyzed<br/>ğŸš¨ 70 Local Alerts<br/>ğŸ”’ 25,505 CAPI Bans"]
        CS_L["ğŸ›¡ï¸ CrowdSec Lady<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>ğŸ“Š Mirror Config<br/>ğŸ”’ Shared CAPI Blocklist"]
        BOUNCER_M["ğŸ”’ Traefik Bouncer M<br/>5,461 Decision Queries"]
        BOUNCER_L["ğŸ”’ Traefik Bouncer L"]
    end
    
    subgraph LAYER4["Layer 4: Authentication"]
        AUTHELIA["ğŸ” Authelia v4.39.15<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ Domain: *.quietly.its.me<br/>ğŸ“± TOTP 2FA Required<br/>ğŸ• Session: 1h expiry<br/>ğŸ’¤ Inactivity: 5m<br/>ğŸ”„ Remember Me: 1 Month"]
    end
    
    subgraph LAYER5["Layer 5: Network Isolation"]
        DOCKER_NET["ğŸ³ Docker Networks<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>172.17.0.0/16 (default)<br/>172.18.0.0/16 (bridge)<br/>172.30.0.0/24 (monitoring)<br/>172.70.9.0/29 (security)"]
        VPN["ğŸŒ VPN Mesh<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Headscale: 100.64.0.0/10<br/>WireGuard: 10.10.0.1/30"]
    end
    
    subgraph THREATS["ğŸ”´ THREAT ANALYSIS"]
        THREAT1["ğŸ“Š HTTP Probing: 12 alerts"]
        THREAT2["ğŸ“Š Sensitive Files: 15 alerts"]
        THREAT3["ğŸ“Š CVE Probing: 14 alerts"]
        THREAT4["ğŸ“Š Backdoor Attempts: 3 alerts"]
        THREAT5["ğŸ“Š WordPress Scans: 3 alerts"]
    end
    
    subgraph ALERTS["ğŸ”” Active Alert Categories"]
        A1["crowdsecurity/http-probing"]
        A2["crowdsecurity/http-cve-probing"]
        A3["crowdsecurity/http-sensitive-files"]
        A4["crowdsecurity/http-admin-interface"]
        A5["crowdsecurity/CVE-2022-41082"]
    end
    
    %% Flow
    CF --> TRAEFIK_M
    CF --> TRAEFIK_L
    TRAEFIK_M <--> CS_M
    TRAEFIK_L <--> CS_L
    CS_M <--> BOUNCER_M
    CS_L <--> BOUNCER_L
    TRAEFIK_M --> AUTHELIA
    AUTHELIA --> DOCKER_NET
    DOCKER_NET <--> VPN
    
    CS_M --> THREAT1
    CS_M --> THREAT2
    CS_M --> THREAT3
    CS_M --> THREAT4
    CS_M --> THREAT5
    
    THREAT1 --> A1
    THREAT3 --> A2
    THREAT2 --> A3
    
    classDef edge fill:#1565C0,stroke:#0D47A1,color:#fff
    classDef security fill:#C62828,stroke:#B71C1C,color:#fff
    classDef auth fill:#7B1FA2,stroke:#4A148C,color:#fff
    classDef network fill:#2E7D32,stroke:#1B5E20,color:#fff
    classDef threat fill:#FF5722,stroke:#E64A19,color:#fff
    
    class LAYER1,LAYER2 edge
    class LAYER3,CS_M,CS_L,BOUNCER_M,BOUNCER_L security
    class LAYER4,AUTHELIA auth
    class LAYER5,DOCKER_NET,VPN network
    class THREATS,THREAT1,THREAT2,THREAT3,THREAT4,THREAT5 threat
```
