# SECURITY STACK VERIFICATION - Agent 2
# Date: February 15, 2026 18:46 UTC
# Verified by: Agent 2

===============================================================================
CROWDSEC VERIFICATION
===============================================================================

=== METRICS ===

Acquisition Metrics:
- Source: /var/log/traefik/access.log
- Lines read: 12,630
- Lines parsed: 12,630
- Lines poured to bucket: 6,060
- Lines whitelisted: 8,730

Local API Alerts:
| Scenario                               | Count |
|----------------------------------------|-------|
| crowdsecurity/http-backdoors-attempts  | 3     |
| crowdsecurity/http-crawl-non_statics   | 4     |
| crowdsecurity/http-path-traversal      | 1     |
| crowdsecurity/http-probing             | 12    |
| crowdsecurity/http-sensitive-files     | 15    |
| crowdsecurity/http-admin-interface     | 4     |
| crowdsecurity/http-cve-probing         | 14    |
| crowdsecurity/http-wordpress-scan      | 3     |
| crowdsecurity/jira_cve-2021-26086      | 2     |
| crowdsecurity/netgear_rce              | 5     |
| crowdsecurity/CVE-2017-9841            | 2     |
| crowdsecurity/CVE-2019-18935           | 1     |
| crowdsecurity/CVE-2022-41082           | 4     |
TOTAL LOCAL ALERTS: 70

CAPI Decisions (Community Blocklist):
| Reason          | Origin | Action | Count  |
|-----------------|--------|--------|--------|
| http:bruteforce | CAPI   | ban    | 2,640  |
| http:crawl      | CAPI   | ban    | 93     |
| http:exploit    | CAPI   | ban    | 640    |
| http:scan       | CAPI   | ban    | 22,132 |
TOTAL CAPI BANS: 25,505

=== SCENARIOS INSTALLED ===
Count: 55 scenarios (from cscli scenarios list)

=== VERIFICATION vs CLAIMS ===

Agent 1 Claim: "42,345 rules" and "1,247 bans"
Agent 2 Finding: 
- 55 scenarios installed
- 25,505 CAPI bans (community blocklist)
- 70 local alerts

DISCREPANCY ANALYSIS:
- "42,345 rules" - unclear metric, likely confused rules with IP blocklist entries
- "1,247 bans" - actual is 25,505 CAPI bans (20x more!)
- CAPI bans are from CrowdSec Central API (community intelligence)

SEVERITY: MINOR for documentation, POSITIVE for security (more protection than claimed)

===============================================================================
AUTHELIA VERIFICATION
===============================================================================

Agent 1 Claim: "18 services protected"
Agent 2 Finding: 4 middleware references in docker-compose files

Verified via: grep -rh "authelia" ~/.docker-compose/*/docker-compose.yaml | grep -c "middleware"
Result: 4

ANALYSIS:
- 4 explicit Authelia middleware references found
- Additional services may be protected via Traefik dynamic config
- Need to check Traefik file provider for complete picture

DISCREPANCY: Agent 1 claimed 18, found 4 explicit references
SEVERITY: MEDIUM - need to verify actual protection scope

===============================================================================
CROWDSEC BOUNCER
===============================================================================

Bouncer Stats:
- Name: traefik-bouncer@172.18.0.8
- Route: /v1/decisions
- Method: GET
- Hits: 5,461

ANALYSIS: Bouncer is actively querying CrowdSec for decisions
STATUS: ‚úÖ FUNCTIONAL

===============================================================================
HEADSCALE (Native Service)
===============================================================================

Status: active (running)
Uptime: 5 days (since Tue 2026-02-10)
Memory: 66.8M
CPU time: 13min 19.079s
Service file: /lib/systemd/system/headscale.service
Drop-in: /etc/systemd/system/headscale.service.d/dns-bootstrap.conf

Agent 1 Claim: 65.9MB RAM
Agent 2 Finding: 66.8MB RAM

MATCH: ‚úÖ Within 1MB variance (normal fluctuation)

===============================================================================
NETWORK VERIFICATION
===============================================================================

IP Addresses (Master):
| Interface  | IP               | Notes              |
|------------|------------------|--------------------|
| lo         | 127.0.0.1/8      | Loopback           |
| eth0       | 213.136.68.108/24| Public IP ‚úÖ       |
| wg0        | 10.10.0.1/30     | WireGuard ‚úÖ       |
| tailscale0 | 100.64.0.1/32    | Tailscale/HS ‚úÖ    |
| docker0    | 172.17.0.1/16    | Docker default     |
| br-*       | Various 172.x    | Docker bridges     |

Tailscale Status:
| IP         | Host   | User    | OS    | Status |
|------------|--------|---------|-------|--------|
| 100.64.0.1 | master | qui3tly | linux | -      |
| 100.64.0.2 | lady   | lady    | linux | active |
| 100.64.0.3 | mac    | qui3tly | macOS | active |

===============================================================================
VERIFICATION SUMMARY
===============================================================================

| Component       | Agent 1 Claim      | Agent 2 Verified   | Status        |
|-----------------|--------------------|--------------------|---------------|
| CrowdSec rules  | 42,345 rules       | 55 scenarios       | ‚ö†Ô∏è CLARIFY    |
| CrowdSec bans   | 1,247 bans         | 25,505 CAPI bans   | üìà HIGHER     |
| Authelia        | 18 services        | 4 explicit refs    | ‚ö†Ô∏è DISCREPANCY|
| Headscale RAM   | 65.9MB             | 66.8MB             | ‚úÖ MATCH      |
| Network IPs     | As documented      | Verified           | ‚úÖ MATCH      |
| Tailscale mesh  | 3 nodes            | 3 nodes verified   | ‚úÖ MATCH      |

OVERALL SECURITY STACK: FUNCTIONAL
Documentation needs: Clarify metrics, verify Authelia scope
